<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutor-Korrekturseite</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        .page {
            padding: 20px;
        }
        .dropdown-card {
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 20px;
            cursor: pointer;
            position: relative;
            display: flex;
            flex-direction: column;
            background-color: white;
            opacity: 1;
        }
        .dropdown-card .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .dropdown-card .details {
            display: none;
            margin-top: 10px;
        }
        .dropdown-card.open .details {
            display: block;
        }
        .student-entry {
            border-top: 1px solid #eee;
            padding: 10px 0;
        }
        .student-entry:first-child {
            border-top: none;
        }
        .button {
            background-color: #007BFF;
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            text-align: center;
            margin-right: 10px;
        }
        .button:hover {
            background-color: #0056b3;
        }
        .upload-button {
            background-color: #28a745;
        }
        .alert {
            display: none;
            background-color: #d4edda;
            color: #155724;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
        }
        .alert.show {
            display: block;
        }
        .points-input {
            width: 50px;
            margin-right: 10px;
        }
    </style>
    <script>
        const submittedAssignments = {
            
            "Aufgabe 1": [
                { name: "Student A", file: "studentA.pdf", points: 0, correction: "" },
                { name: "Student B", file: "studentB.pdf", points: 0, correction: "" }
            ],
            "Aufgabe 2": [
                { name: "Student C", file: "studentC.pdf", points: 0, correction: "" }
            ]
        };

        function toggleDropdown(card) {
            card.classList.toggle('open');
        }

        function handleDownload(fileName) {
            const link = document.createElement('a');
            link.href = '#'; // Pfad anpassen
            link.download = fileName;
            link.click();
        }

        function handlePointsChange(event, assignment, student) {
            const points = event.target.value;
            submittedAssignments[assignment].forEach(s => {
                if (s.name === student.name) {
                    s.points = points;
                }
            });
        }

        function handleCorrectionUpload(event, assignment, student) {
            const input = document.createElement('input');
            input.type = 'file';

            input.onchange = function(e) {
                const fileName = e.target.files[0].name;
                student.correction = fileName;

                const alertBox = document.getElementById('correctionAlert');
                alertBox.textContent = `Korrekturdatei "${fileName}" für ${student.name} hochgeladen`;
                alertBox.classList.add('show');
                setTimeout(() => {
                    alertBox.classList.remove('show');
                }, 3000);
            };
            input.click();
        }

        window.onload = function() {
            const page = document.getElementById('tutorPage');

            for (const assignment in submittedAssignments) {
                const card = document.createElement('div');
                card.className = 'dropdown-card';
                card.onclick = function() { toggleDropdown(card); };

                const header = document.createElement('div');
                header.className = 'header';
                header.innerHTML = `<h2>${assignment}</h2>`;
                card.appendChild(header);

                const details = document.createElement('div');
                details.className = 'details';

                submittedAssignments[assignment].forEach(student => {
                    const entry = document.createElement('div');
                    entry.className = 'student-entry';
                    entry.innerHTML = `
                        <span>${student.name}</span>
                        <button class="button" onclick="handleDownload('${student.file}'); event.stopPropagation();">Download</button>
                        <input type="number" class="points-input" min="0" max="100" value="${student.points}" onchange="handlePointsChange(event, '${assignment}', submittedAssignments['${assignment}'].find(s => s.name === '${student.name}'));">
                        <button class="button upload-button" onclick="handleCorrectionUpload(event, '${assignment}', submittedAssignments['${assignment}'].find(s => s.name === '${student.name}'));">Korrektur hochladen</button>
                    `;
                    details.appendChild(entry);
                });

                card.appendChild(details);
                page.appendChild(card);
            }
        };
    </script>
</head>
<body>

<div id="tutorPage" class="page">
    <h1>Korrekturübersicht</h1>
    <div id="correctionAlert" class="alert">Korrekturdatei hochgeladen</div>
</div>

</body>
</html>